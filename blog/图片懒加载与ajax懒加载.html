<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>图片懒加载和ajax懒加载 | caihai123</title>
    <meta name="generator" content="VuePress 1.8.1">
    <script src="/documents/static/js/clicklove.js"></script>
    <meta name="description" content="这个是篇关键字">
    
    <link rel="preload" href="/documents/assets/css/0.styles.db21a181.css" as="style"><link rel="preload" href="/documents/assets/js/app.af21e729.js" as="script"><link rel="preload" href="/documents/assets/js/2.e76dce23.js" as="script"><link rel="preload" href="/documents/assets/js/30.9b173383.js" as="script"><link rel="prefetch" href="/documents/assets/js/10.60030ce1.js"><link rel="prefetch" href="/documents/assets/js/11.25ae8904.js"><link rel="prefetch" href="/documents/assets/js/12.db0a5c21.js"><link rel="prefetch" href="/documents/assets/js/13.f5551591.js"><link rel="prefetch" href="/documents/assets/js/14.8683b2fd.js"><link rel="prefetch" href="/documents/assets/js/15.23bbd255.js"><link rel="prefetch" href="/documents/assets/js/16.626d0906.js"><link rel="prefetch" href="/documents/assets/js/17.1e984671.js"><link rel="prefetch" href="/documents/assets/js/18.1217a96d.js"><link rel="prefetch" href="/documents/assets/js/19.8083d39d.js"><link rel="prefetch" href="/documents/assets/js/20.f711d207.js"><link rel="prefetch" href="/documents/assets/js/21.9de72aab.js"><link rel="prefetch" href="/documents/assets/js/22.78b12ed2.js"><link rel="prefetch" href="/documents/assets/js/23.fb07aed4.js"><link rel="prefetch" href="/documents/assets/js/24.b047b997.js"><link rel="prefetch" href="/documents/assets/js/25.0583b41b.js"><link rel="prefetch" href="/documents/assets/js/26.5c57f31b.js"><link rel="prefetch" href="/documents/assets/js/27.7d29e838.js"><link rel="prefetch" href="/documents/assets/js/28.358631e5.js"><link rel="prefetch" href="/documents/assets/js/29.30eb2dfd.js"><link rel="prefetch" href="/documents/assets/js/3.8fd369df.js"><link rel="prefetch" href="/documents/assets/js/31.3fdd407f.js"><link rel="prefetch" href="/documents/assets/js/32.c25c73f0.js"><link rel="prefetch" href="/documents/assets/js/33.fe652afd.js"><link rel="prefetch" href="/documents/assets/js/34.b55b1a28.js"><link rel="prefetch" href="/documents/assets/js/35.ff2c9ad1.js"><link rel="prefetch" href="/documents/assets/js/36.2b4aa20a.js"><link rel="prefetch" href="/documents/assets/js/37.b88df957.js"><link rel="prefetch" href="/documents/assets/js/4.25f6b541.js"><link rel="prefetch" href="/documents/assets/js/5.692bcc0a.js"><link rel="prefetch" href="/documents/assets/js/6.07df3592.js"><link rel="prefetch" href="/documents/assets/js/7.d13d6751.js"><link rel="prefetch" href="/documents/assets/js/8.e4409a99.js"><link rel="prefetch" href="/documents/assets/js/9.edf20759.js">
    <link rel="stylesheet" href="/documents/assets/css/0.styles.db21a181.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/documents/" class="home-link router-link-active"><!----> <span class="site-name">caihai123</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/documents/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/documents/record/" class="nav-link">
  记录文档
</a></div><div class="nav-item"><a href="/documents/plugin/" class="nav-link">
  收藏夹
</a></div><div class="nav-item"><a href="/documents/blog/" class="nav-link router-link-active">
  博客列表
</a></div> <a href="https://github.com/caihai123/documents" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/documents/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/documents/record/" class="nav-link">
  记录文档
</a></div><div class="nav-item"><a href="/documents/plugin/" class="nav-link">
  收藏夹
</a></div><div class="nav-item"><a href="/documents/blog/" class="nav-link router-link-active">
  博客列表
</a></div> <a href="https://github.com/caihai123/documents" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>博客列表</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/documents/blog/" aria-current="page" class="sidebar-link">介绍</a></li><li><a href="/documents/blog/图片懒加载与ajax懒加载.html" class="active sidebar-link">图片懒加载和ajax懒加载</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/documents/blog/图片懒加载与ajax懒加载.html#图片的懒加载" class="sidebar-link">图片的懒加载</a></li><li class="sidebar-sub-header"><a href="/documents/blog/图片懒加载与ajax懒加载.html#ajax的懒加载" class="sidebar-link">ajax的懒加载</a></li></ul></li><li><a href="/documents/blog/后端返回的long型数据丢失.html" class="sidebar-link">后端返回的long型数据丢失</a></li><li><a href="/documents/blog/网页背景水印代码记录.html" class="sidebar-link">网页背景水印</a></li><li><a href="/documents/blog/lodash的debounce仿抖动函数.html" class="sidebar-link">lodash的debounce仿抖动函数</a></li><li><a href="/documents/blog/es6模块.html" class="sidebar-link">export与import(ES6 module模快)</a></li><li><a href="/documents/blog/es6构造函数.html" class="sidebar-link">ES6构造函数</a></li><li><a href="/documents/blog/javascript原型.html" class="sidebar-link">详细记录js的原型链</a></li><li><a href="/documents/blog/HTTP Cache-Control 缓存机制.html" class="sidebar-link">HTTP Cache-Control 缓存机制</a></li><li><a href="/documents/blog/使用Travis CI自动部署GitHub Pages页面.html" class="sidebar-link">使用Travis CI自动部署GitHub Pages页面</a></li><li><a href="/documents/blog/前端数据字典最优方案.html" class="sidebar-link">前端数据字典的最优方案探索</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>上周遇到一个功能，在一片可滚动区域，需要实现dom里面内容的懒加载，也就是当滚动到某个（或多个）div的时候，执行异步请求，获取这个div需要的数据，再将这个div的完整样式渲染出来，在此之前这个div只有一些基本数据。因为以前也做过图片的懒加载，所以当时还觉得应该不是很复杂，可是后面仔细想想却发现要考虑的东西完全比做图片的多，百度一下也大多只有图片的懒加载，只能趁着周末自己研究了一下，总算是找到了一种方案，在此记录一下。</p> <h2 id="图片的懒加载"><a href="#图片的懒加载" class="header-anchor">#</a> 图片的懒加载</h2> <p>在之前先记录一下图片的懒加载，网上代码也是一大推，但是基本思路都差不多，就是我们在写html的时候，将需要懒加载的img的src属性留为空或用一张默认图片地址，然后在img上添加一个属性，如：‘data-src’保存img真正的图片地址，最后在可滚动的容器上添加onscroll事件，当容器滚动的时候执行onscroll上的函数，通过一些计算找到当前能被用户观测到的img，然后将这些img的data-src属性值加到src上，这样就能实现图片的懒加载了，完整示例代码如下：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>图片懒加载<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
            <span class="token selector">#container</span><span class="token punctuation">{</span><span class="token property">width</span><span class="token punctuation">:</span> 1200px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span>650px<span class="token punctuation">;</span><span class="token property">margin</span><span class="token punctuation">:</span> 0 auto<span class="token punctuation">;</span><span class="token property">overflow</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span><span class="token property">background-color</span><span class="token punctuation">:</span> #4183c4<span class="token punctuation">;</span><span class="token punctuation">}</span>
            <span class="token selector">img</span><span class="token punctuation">{</span><span class="token property">width</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span> 150px<span class="token punctuation">;</span><span class="token punctuation">}</span>
        </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://caihai123.github.io/Dribbble/lists/news_teaser.png<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://caihai123.github.io/Dribbble/lists/preview_teaser.png<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://caihai123.github.io/Dribbble/lists/car_teaser.gif<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://caihai123.github.io/Dribbble/lists/artboard_38_teaser.png<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://caihai123.github.io/Dribbble/lists/messi-video_teaser.png<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://caihai123.github.io/Dribbble/lists/stock_app_ui_design_light_tubik_teaser.png<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://caihai123.github.io/Dribbble/lists/learning.png<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://caihai123.github.io/Dribbble/lists/swtich.gif<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://caihai123.github.io/Dribbble/lists/goa_teaser.jpg<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://caihai123.github.io/Dribbble/lists/block-tube.png<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://caihai123.github.io/Dribbble/lists/148.2.pre.png<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://caihai123.github.io/Dribbble/lists/ro_2x_teaser.png<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://caihai123.github.io/Dribbble/lists/portals_10-09.png<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://caihai123.github.io/Dribbble/lists/screen-shot.jpg<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://caihai123.github.io/Dribbble/lists/race_animation.png<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://caihai123.github.io/Dribbble/lists/dz_xn3lw0aiyrt6.jpg<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://caihai123.github.io/Dribbble/lists/news_teaser.png<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://caihai123.github.io/Dribbble/lists/preview_teaser.png<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://caihai123.github.io/Dribbble/lists/car_teaser.gif<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://caihai123.github.io/Dribbble/lists/portals_10-09.png<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
            <span class="token keyword">var</span> img <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">&quot;img&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//我这里是获取的所有img，因为我所有img都需要懒加载</span>
            <span class="token keyword">var</span> len <span class="token operator">=</span> img<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
            <span class="token keyword">var</span> container <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;container&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> <span class="token function-variable function">lazyLoad</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">var</span> seeHeight <span class="token operator">=</span> <span class="token number">800</span><span class="token punctuation">;</span><span class="token comment">//获取容器的高度，在本例中我的容器高度已固定为800px</span>
                <span class="token keyword">var</span> scrollTop <span class="token operator">=</span> container<span class="token punctuation">.</span>scrollTop<span class="token punctuation">;</span><span class="token comment">//获取滚动条距离顶部的距离</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>img<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>offsetTop <span class="token operator">&lt;</span> seeHeight <span class="token operator">+</span> scrollTop<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token comment">//这里的逻辑判断得注意，写的比较简单是因为本例中滚动条只能上下滚动而且初始化的时候就在最顶部（一般都是这样），也没有限制lazyLoad执行频率，当滚动条从上面滚动到下面的时候，所有img都会加载，所以才只使用了offsetTop做判断</span>
                        <span class="token keyword">var</span> src <span class="token operator">=</span> img<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;src&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">var</span> dataSrc <span class="token operator">=</span> img<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;data-src&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>src <span class="token operator">!=</span> dataSrc<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            img<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>src <span class="token operator">=</span> dataSrc<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token function">lazyLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            container<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'scroll'</span><span class="token punctuation">,</span> lazyLoad<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="ajax的懒加载"><a href="#ajax的懒加载" class="header-anchor">#</a> ajax的懒加载</h2> <p>现在来说今天的主角，因为我们项目是用vue做的，所以我的示例也是。原理呢和上面图片的懒加载一样，只是多了点需要考虑的东西；上面的代码中，因为它是图片，当它的src属性里的地址改变后，他会自动发起请求去获取这张图片，然后在自己身上渲染出来；但是在我的项目中，所有div都是通过一个lists数据渲染出来的，每个div会渲染成什么样取决于它在lists中的数据是否完整，所以我要想实现懒加载的功能，不仅需要找到当前dom元素，还要找到dom元素在lists中对应的元素，判断他是否完整，如果不完整，通过ajax去请求数据，然后再添加到该元素的数据中。</p> <p>然后说一下解决办法：在上面的代码中，我们可以通过添加一个属性data-src来存放我们得图片地址，所以我们也可以用它来存点别的，比如我们每个div请求时需要的参数（id），但是我们请求的结果最终是添加到lists中的哪个元素上呢，所以我们还需要将div在list中的索引也存上去，这样当请求结果返回的时候，我们就知道这些数据该添加到添加到哪里了，只要数据添加对了，vue的特性自然会将数据在div上渲染出来，下面是示例代码：</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>container<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-card</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>(list,index) in lists<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>index<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>card<span class="token punctuation">'</span></span> <span class="token attr-name">:data-id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>list.id<span class="token punctuation">'</span></span> <span class="token attr-name">:data-index</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>index<span class="token punctuation">'</span></span> <span class="token attr-name">:data-sign</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>list.sign<span class="token punctuation">'</span></span> <span class="token attr-name">v-loading</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>list.loading<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>header<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>{list.table}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>card-main<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>{list.name}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>{list.age}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-card</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
        name<span class="token operator">:</span><span class="token string">&quot;lazyLoad&quot;</span><span class="token punctuation">,</span>
        <span class="token function-variable function">data</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                lists<span class="token operator">:</span><span class="token punctuation">[</span>
                    <span class="token punctuation">{</span>
                        table<span class="token operator">:</span><span class="token string">&quot;第1个&quot;</span><span class="token punctuation">,</span><span class="token comment">//原始数据</span>
                        id<span class="token operator">:</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span> <span class="token comment">//原始数据，需要用它去获取完整数据</span>
                        name<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token comment">//完整数据中的name，还没有获取的数据</span>
                        age<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token comment">//完整数据中的age，还没有获取的数据</span>
                        sign<span class="token operator">:</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span><span class="token comment">//标记，用来判断是否已经获取到完整数据</span>
                        loading<span class="token operator">:</span><span class="token boolean">false</span><span class="token comment">//加载数据时显示动效</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>table<span class="token operator">:</span><span class="token string">&quot;第2个&quot;</span><span class="token punctuation">,</span>id<span class="token operator">:</span><span class="token string">&quot;2&quot;</span><span class="token punctuation">,</span> name<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>age<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>sign<span class="token operator">:</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>loading<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>table<span class="token operator">:</span><span class="token string">&quot;第3个&quot;</span><span class="token punctuation">,</span>id<span class="token operator">:</span><span class="token string">&quot;3&quot;</span><span class="token punctuation">,</span> name<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>age<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>sign<span class="token operator">:</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>loading<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>table<span class="token operator">:</span><span class="token string">&quot;第4个&quot;</span><span class="token punctuation">,</span>id<span class="token operator">:</span><span class="token string">&quot;4&quot;</span><span class="token punctuation">,</span> name<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>age<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>sign<span class="token operator">:</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>loading<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>table<span class="token operator">:</span><span class="token string">&quot;第5个&quot;</span><span class="token punctuation">,</span>id<span class="token operator">:</span><span class="token string">&quot;5&quot;</span><span class="token punctuation">,</span> name<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>age<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>sign<span class="token operator">:</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>loading<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>table<span class="token operator">:</span><span class="token string">&quot;第6个&quot;</span><span class="token punctuation">,</span>id<span class="token operator">:</span><span class="token string">&quot;6&quot;</span><span class="token punctuation">,</span> name<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>age<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>sign<span class="token operator">:</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>loading<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>table<span class="token operator">:</span><span class="token string">&quot;第7个&quot;</span><span class="token punctuation">,</span>id<span class="token operator">:</span><span class="token string">&quot;7&quot;</span><span class="token punctuation">,</span> name<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>age<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>sign<span class="token operator">:</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>loading<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>table<span class="token operator">:</span><span class="token string">&quot;第8个&quot;</span><span class="token punctuation">,</span>id<span class="token operator">:</span><span class="token string">&quot;8&quot;</span><span class="token punctuation">,</span> name<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>age<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>sign<span class="token operator">:</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>loading<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>table<span class="token operator">:</span><span class="token string">&quot;第9个&quot;</span><span class="token punctuation">,</span>id<span class="token operator">:</span><span class="token string">&quot;9&quot;</span><span class="token punctuation">,</span> name<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>age<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>sign<span class="token operator">:</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>loading<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>table<span class="token operator">:</span><span class="token string">&quot;第10个&quot;</span><span class="token punctuation">,</span>id<span class="token operator">:</span><span class="token string">&quot;10&quot;</span><span class="token punctuation">,</span> name<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>age<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>sign<span class="token operator">:</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>loading<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>table<span class="token operator">:</span><span class="token string">&quot;第11个&quot;</span><span class="token punctuation">,</span>id<span class="token operator">:</span><span class="token string">&quot;11&quot;</span><span class="token punctuation">,</span> name<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>age<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>sign<span class="token operator">:</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>loading<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>table<span class="token operator">:</span><span class="token string">&quot;第12个&quot;</span><span class="token punctuation">,</span>id<span class="token operator">:</span><span class="token string">&quot;12&quot;</span><span class="token punctuation">,</span> name<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>age<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>sign<span class="token operator">:</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>loading<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>table<span class="token operator">:</span><span class="token string">&quot;第13个&quot;</span><span class="token punctuation">,</span>id<span class="token operator">:</span><span class="token string">&quot;13&quot;</span><span class="token punctuation">,</span> name<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>age<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>sign<span class="token operator">:</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>loading<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>table<span class="token operator">:</span><span class="token string">&quot;第14个&quot;</span><span class="token punctuation">,</span>id<span class="token operator">:</span><span class="token string">&quot;14&quot;</span><span class="token punctuation">,</span> name<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>age<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>sign<span class="token operator">:</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>loading<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>table<span class="token operator">:</span><span class="token string">&quot;第15个&quot;</span><span class="token punctuation">,</span>id<span class="token operator">:</span><span class="token string">&quot;15&quot;</span><span class="token punctuation">,</span> name<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>age<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>sign<span class="token operator">:</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>loading<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>table<span class="token operator">:</span><span class="token string">&quot;第16个&quot;</span><span class="token punctuation">,</span>id<span class="token operator">:</span><span class="token string">&quot;16&quot;</span><span class="token punctuation">,</span> name<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>age<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>sign<span class="token operator">:</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>loading<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>table<span class="token operator">:</span><span class="token string">&quot;第17个&quot;</span><span class="token punctuation">,</span>id<span class="token operator">:</span><span class="token string">&quot;17&quot;</span><span class="token punctuation">,</span> name<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>age<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>sign<span class="token operator">:</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>loading<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>table<span class="token operator">:</span><span class="token string">&quot;第18个&quot;</span><span class="token punctuation">,</span>id<span class="token operator">:</span><span class="token string">&quot;18&quot;</span><span class="token punctuation">,</span> name<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>age<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>sign<span class="token operator">:</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>loading<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>table<span class="token operator">:</span><span class="token string">&quot;第19个&quot;</span><span class="token punctuation">,</span>id<span class="token operator">:</span><span class="token string">&quot;19&quot;</span><span class="token punctuation">,</span> name<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>age<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>sign<span class="token operator">:</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>loading<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>table<span class="token operator">:</span><span class="token string">&quot;第20个&quot;</span><span class="token punctuation">,</span>id<span class="token operator">:</span><span class="token string">&quot;20&quot;</span><span class="token punctuation">,</span> name<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>age<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>sign<span class="token operator">:</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>loading<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>table<span class="token operator">:</span><span class="token string">&quot;第21个&quot;</span><span class="token punctuation">,</span>id<span class="token operator">:</span><span class="token string">&quot;21&quot;</span><span class="token punctuation">,</span> name<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>age<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>sign<span class="token operator">:</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>loading<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>table<span class="token operator">:</span><span class="token string">&quot;第22个&quot;</span><span class="token punctuation">,</span>id<span class="token operator">:</span><span class="token string">&quot;22&quot;</span><span class="token punctuation">,</span> name<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>age<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>sign<span class="token operator">:</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>loading<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>table<span class="token operator">:</span><span class="token string">&quot;第23个&quot;</span><span class="token punctuation">,</span>id<span class="token operator">:</span><span class="token string">&quot;23&quot;</span><span class="token punctuation">,</span> name<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>age<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>sign<span class="token operator">:</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>loading<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>table<span class="token operator">:</span><span class="token string">&quot;第24个&quot;</span><span class="token punctuation">,</span>id<span class="token operator">:</span><span class="token string">&quot;24&quot;</span><span class="token punctuation">,</span> name<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>age<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>sign<span class="token operator">:</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>loading<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">mounted</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">let</span> _ <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'lodash'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">lazyLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token string">&quot;container&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'scroll'</span><span class="token punctuation">,</span>_<span class="token punctuation">.</span><span class="token function">debounce</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>lazyLoad<span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        methods<span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token function-variable function">lazyLoad</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">var</span> container <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token string">&quot;container&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> cards <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token string">&quot;card&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> len <span class="token operator">=</span> cards<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
                <span class="token keyword">var</span> seeHeight <span class="token operator">=</span> <span class="token number">650</span><span class="token punctuation">;</span><span class="token comment">//获取容器的高度，在本例中我的容器高度已固定为650px</span>
                <span class="token keyword">var</span> scrollTop <span class="token operator">=</span> container<span class="token punctuation">.</span>scrollTop<span class="token punctuation">;</span><span class="token comment">//获取滚动条距离顶部的距离</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>cards<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>offsetTop <span class="token operator">&lt;</span> seeHeight <span class="token operator">+</span> scrollTop <span class="token operator">&amp;&amp;</span> cards<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>offsetTop <span class="token operator">+</span> <span class="token number">200</span> <span class="token operator">&gt;</span> scrollTop<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword">var</span> sign <span class="token operator">=</span> cards<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;data-sign&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">if</span><span class="token punctuation">(</span>sign <span class="token operator">===</span> <span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                            <span class="token keyword">var</span> id <span class="token operator">=</span> cards<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;data-id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token keyword">var</span> index <span class="token operator">=</span> cards<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;data-index&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">simulationAjax</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span> 
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token comment">//模拟ajax请求额函数</span>
            <span class="token function-variable function">simulationAjax</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span>index</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">var</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
                self<span class="token punctuation">.</span>lists<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>loading <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                    <span class="token comment">//通过id去获取到obj</span>
                    <span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
                        name<span class="token operator">:</span><span class="token string">&quot;蔡海&quot;</span><span class="token punctuation">,</span>
                        age<span class="token operator">:</span><span class="token string">&quot;18&quot;</span>
                    <span class="token punctuation">}</span>
                    self<span class="token punctuation">.</span>lists<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name <span class="token operator">=</span> obj<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
                    self<span class="token punctuation">.</span>lists<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>age <span class="token operator">=</span> obj<span class="token punctuation">.</span>age<span class="token punctuation">;</span>
                    self<span class="token punctuation">.</span>lists<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>sign <span class="token operator">=</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">;</span>
                    self<span class="token punctuation">.</span>lists<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>loading <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span> 
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
    <span class="token selector">.container</span><span class="token punctuation">{</span>
        <span class="token property">width</span><span class="token punctuation">:</span> 1200px<span class="token punctuation">;</span>
        <span class="token property">height</span><span class="token punctuation">:</span> 650px<span class="token punctuation">;</span>
        <span class="token property">margin</span><span class="token punctuation">:</span> 0 auto<span class="token punctuation">;</span>
        <span class="token property">overflow</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>
        <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
        <span class="token property">flex-wrap</span><span class="token punctuation">:</span>wrap<span class="token punctuation">;</span>
        <span class="token property">justify-content</span><span class="token punctuation">:</span>space-around<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.card</span><span class="token punctuation">{</span>
        <span class="token property">width</span><span class="token punctuation">:</span> 350px<span class="token punctuation">;</span>
        <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
        <span class="token property">background-color</span><span class="token punctuation">:</span> #4183c4<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.card-main</span><span class="token punctuation">{</span>
        <span class="token property">min-height</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>在本例中，有几处模板语法的错误，原因是这个语法和我网站的语法有冲突，所以我少写了一个{}，有时间优化一下，还有就是我给scroll事件添加了debounce函数控制事件执行的频率，不知道这个的可以点击<a href="/documents/blog/lodash的debounce仿抖动函数.html">lodash的debounce仿抖动函数</a>查看我的另一篇boke。
再见~</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新：:</span> <span class="time">3/11/2020, 11:37:05 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/documents/blog/" class="prev router-link-active">
        介绍
      </a></span> <span class="next"><a href="/documents/blog/后端返回的long型数据丢失.html">
        后端返回的long型数据丢失
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/documents/assets/js/app.af21e729.js" defer></script><script src="/documents/assets/js/2.e76dce23.js" defer></script><script src="/documents/assets/js/30.9b173383.js" defer></script>
  </body>
</html>
